<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ì ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶™‡¶ø</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --primary-hover-color: #0056b3;
            --secondary-color: #6c757d;
            --secondary-hover-color: #5a6268;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-bg: #f8f9fa;
            --white-bg: #ffffff;
            --text-color: #212529;
            --border-color: #dee2e6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
        }

        body {
            font-family: 'Noto Sans Bengali', sans-serif;
            margin: 0;
            background-color: var(--light-bg);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            background: var(--white-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-weight: 700;
            cursor: help;
            transition: transform 0.3s ease;
        }

        h1:hover {
            transform: scale(1.05);
        }

        .info {
            background-color: #e7f3fe;
            border-left: 5px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 4px;
            font-size: 0.95em;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            box-sizing: border-box;
            height: 250px;
            font-family: monospace;
            font-size: 14px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        button {
            padding: 12px 15px;
            color: white;
            background-color: var(--primary-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: var(--primary-hover-color);
            transform: translateY(-2px);
        }
        
        button.clear-btn {
            background-color: var(--secondary-color);
        }

        button.clear-btn:hover {
            background-color: var(--secondary-hover-color);
        }

        button.copy-all-btn {
            background-color: var(--success-color);
        }

        button.copy-all-btn:hover {
            background-color: #218838;
        }

        #resultsContainer h2 {
            margin-bottom: 15px;
            color: #333;
        }

        #resultsTableContainer {
            overflow-x: auto;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
            font-family: monospace;
            font-size: 14px;
        }

        .result-table th, .result-table td {
            border: 1px solid var(--border-color);
            padding: 10px;
            text-align: left;
        }

        .result-table th {
            background-color: var(--light-bg);
            font-weight: 700;
            position: sticky;
            top: 0;
        }
        
        .result-table tr:nth-child(even) {
            background-color: #fdfdfd;
        }

        .result-table td:first-child, .result-table th:first-child {
            text-align: center;
            width: 50px;
            font-weight: 500;
        }

        .result-table td:last-child, .result-table th:last-child {
            text-align: center;
            width: 60px;
        }

        .copy-row-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 1.2em;
            padding: 0;
            transition: color 0.2s, transform 0.2s;
        }

        .copy-row-btn:hover {
            color: var(--primary-hover-color);
            background: none;
            transform: scale(1.2);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
        }

        #copyNotification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            z-index: 1000;
            font-size: 16px;
            font-weight: 500;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
        }

        #copyNotification.show {
            display: block;
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        #copyNotification.success {
            background-color: var(--success-color);
        }

        #copyNotification.error {
            background-color: var(--danger-color);
        }

        .result-table tr.copied td {
            background-color: #d4edda;
        }

        /* Easter egg styles */
        .secret-mode {
            animation: rainbow 3s linear infinite;
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            pointer-events: none;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>

    <main class="container">
        <header>
            <h1 title="‡¶ü‡ßç‡¶∞‡¶ø‡¶™‡¶≤ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®! üéâ">‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ì ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶™‡¶ø</h1>
            <section class="info">
                <p>‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨-‡¶∏‡ßá‡¶™‡¶æ‡¶∞‡ßá‡¶ü‡ßá‡¶° ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶è‡¶∞‡¶™‡¶∞ <strong>"‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®"</strong> ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞, ‡¶á‡¶ö‡ßç‡¶õ‡¶æ‡¶Æ‡¶§‡ßã ‡¶∏‡¶æ‡¶∞‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡¶™‡¶ø (`Ctrl+C`) ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶ì ‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ï‡¶™‡¶ø ‡¶π‡¶¨‡ßá‡•§</p>
                <p>‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞: <strong>"‡¶∏‡¶¨ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®"</strong> ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶ì ‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡¶ø‡¶∞ ‡¶™‡¶æ‡¶∂‡ßá ‡¶•‡¶æ‡¶ï‡¶æ ‡¶ï‡¶™‡¶ø ‡¶Ü‡¶á‡¶ï‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∏‡ßá‡¶á ‡¶∏‡¶æ‡¶∞‡¶ø‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
            </section>
        </header>

        <section>
            <label for="inputText"><strong>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®:</strong></label>
            <textarea id="inputText" placeholder="‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶®‡¶Ç	‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶®‡¶Ç	‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø..."></textarea>
            
            <div class="button-group">
                <button id="rearrangeBtn">‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button id="copyAllBtn" class="copy-all-btn">‡¶∏‡¶¨ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button id="clearBtn" class="clear-btn">‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®</button>
            </div>
        </section>
        
        <section id="resultsContainer">
            <h2>‡¶´‡¶≤‡¶æ‡¶´‡¶≤:</h2>
            <div id="resultsTableContainer">
                <div class="empty-state">‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§</div>
            </div>
        </section>
    </main>

    <div id="copyNotification" role="alert" aria-live="polite"></div>

    <script>
        'use strict';

        document.addEventListener('DOMContentLoaded', () => {
            const rearrangeBtn = document.getElementById('rearrangeBtn');
            const clearBtn = document.getElementById('clearBtn');
            const copyAllBtn = document.getElementById('copyAllBtn');
            const inputText = document.getElementById('inputText');
            const resultsTableContainer = document.getElementById('resultsTableContainer');
            const notification = document.getElementById('copyNotification');
            const h1 = document.querySelector('h1');

            let clickCount = 0;
            let konamiCode = [];
            const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

            // Easter Egg 1: Triple-click header
            h1.addEventListener('click', () => {
                clickCount++;
                if (clickCount === 3) {
                    document.body.classList.toggle('secret-mode');
                    showNotification('üåà ‡¶∞‡¶Ç‡¶ß‡¶®‡ßÅ ‡¶Æ‡ßã‡¶° ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º! üåà', 'success');
                    createConfetti();
                    clickCount = 0;
                }
                setTimeout(() => clickCount = 0, 1000);
            });

            // Easter Egg 2: Konami Code
            document.addEventListener('keydown', (e) => {
                konamiCode.push(e.key);
                if (konamiCode.length > 10) konamiCode.shift();
                
                if (JSON.stringify(konamiCode) === JSON.stringify(konamiSequence)) {
                    showNotification('üéÆ ‡¶ï‡ßã‡¶®‡¶æ‡¶Æ‡¶ø ‡¶ï‡ßã‡¶° ‡¶Ü‡¶®‡¶≤‡¶ï! ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ï‡¶ú‡¶® ‡¶ï‡¶ø‡¶Ç‡¶¨‡¶¶‡¶®‡ßç‡¶§‡¶ø! üéÆ', 'success');
                    createMassiveConfetti();
                    konamiCode = [];
                }
            });

            // Easter Egg 3: Type "debug" in textarea
            let typedText = '';
            inputText.addEventListener('keyup', () => {
                typedText = inputText.value.toLowerCase();
                if (typedText.includes('debug')) {
                    console.log('üêõ Debug mode activated! Here are some stats:');
                    console.log('Lines:', inputText.value.split('\n').length);
                    console.log('Characters:', inputText.value.length);
                    console.log('Developer appreciation level: üíØ');
                }
            });

            function createConfetti() {
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + '%';
                        confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                        confetti.style.animationDelay = Math.random() * 0.5 + 's';
                        document.body.appendChild(confetti);
                        setTimeout(() => confetti.remove(), 3000);
                    }, i * 30);
                }
            }

            function createMassiveConfetti() {
                for (let i = 0; i < 200; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + '%';
                        confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                        document.body.appendChild(confetti);
                        setTimeout(() => confetti.remove(), 3000);
                    }, i * 10);
                }
            }

            // Original functionality with fixes
            const savedText = sessionStorage.getItem('inputTextContent');
            if (savedText) {
                inputText.value = savedText;
            }

            inputText.addEventListener('input', () => {
                sessionStorage.setItem('inputTextContent', inputText.value);
            });

            const showNotification = (message, type = 'success') => {
                notification.textContent = message;
                notification.className = `show ${type}`;
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 2500);
            };

            const buildTable = (header, dataLines) => {
                let tableHTML = '<table class="result-table"><caption>‡¶ó‡ßç‡¶∞‡ßÅ‡¶™ ‡¶ï‡¶∞‡¶æ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü‡ßá‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤</caption>';
                
                tableHTML += '<thead><tr><th>‡¶®‡¶Ç</th>';
                header.split('\t').forEach(part => tableHTML += `<th scope="col">${part}</th>`);
                tableHTML += '<th scope="col">‡¶ï‡¶™‡¶ø</th>';
                tableHTML += '</tr></thead>';

                tableHTML += '<tbody>';
                dataLines.forEach((line, index) => {
                    const cells = line.split('\t');
                    tableHTML += `<tr><td>${index + 1}</td>`;
                    cells.forEach(cell => tableHTML += `<td>${cell}</td>`);
                    tableHTML += `<td><button class="copy-row-btn" data-holding="${cells[0]}" data-khatian="${cells[1]}" title="‡¶è‡¶á ‡¶∏‡¶æ‡¶∞‡¶ø ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®">üìã</button></td>`;
                    tableHTML += '</tr>';
                });
                tableHTML += '</tbody></table>';

                return tableHTML;
            };

            const rearrangeText = () => {
                const text = inputText.value;
                if (!text.trim()) {
                    resultsTableContainer.innerHTML = '<div class="empty-state">‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>';
                    showNotification('‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶¨‡¶ï‡ßç‡¶∏ ‡¶ñ‡¶æ‡¶≤‡¶ø!', 'error');
                    return;
                }

                const lines = text.split('\n').filter(line => line.trim() !== '');

                if (lines.length < 2) {
                    resultsTableContainer.innerHTML = '<div class="empty-state">‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶∏‡¶π ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡¶æ‡¶á‡¶® ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§</div>';
                    return;
                }

                const header = lines[0];
                const dataLines = lines.slice(1);
                const groups = {};

                dataLines.forEach(line => {
                    const parts = line.split('\t');
                    const comment = parts.length > 2 ? parts.slice(2).join('\t').trim() : '‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø ‡¶®‡ßá‡¶á';
                    if (!groups[comment]) {
                        groups[comment] = [];
                    }
                    groups[comment].push(line);
                });

                const outputLines = Object.values(groups).flat();
                
                const tableHTML = buildTable(header, outputLines);
                resultsTableContainer.innerHTML = tableHTML;
                
                const table = resultsTableContainer.querySelector('.result-table');
                if (table) {
                    table.addEventListener('copy', handleSmartCopy);
                    table.querySelectorAll('.copy-row-btn').forEach(button => {
                        button.addEventListener('click', (event) => {
                            const holding = event.target.dataset.holding;
                            const khatian = event.target.dataset.khatian;
                            copyToClipboard(`${holding}\t${khatian}`);
                            showNotification('‚úÖ ‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶ì ‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');

                            const row = event.target.closest('tr');
                            if (row) {
                                row.classList.add('copied');
                            }
                        });
                    });
                }
            };
            
            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                    // Success handled by calling function
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                    showNotification('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•!', 'error');
                });
            };

            const handleSmartCopy = (event) => {
                event.preventDefault();

                const selection = window.getSelection();
                if (selection.rangeCount === 0) return;

                const range = selection.getRangeAt(0);
                const selectedFragment = range.cloneContents();
                
                const tempDiv = document.createElement('div');
                tempDiv.appendChild(selectedFragment);

                let copyText = '';
                const rows = tempDiv.querySelectorAll('tr');

                if (rows.length > 0) {
                    const selectedData = [];
                    rows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 3) {
                             selectedData.push(`${cells[1].textContent}\t${cells[2].textContent}`);
                        }
                    });
                    copyText = selectedData.join('\n');
                } else {
                    const parentRow = range.startContainer.parentElement.closest('tr');
                    if (parentRow) {
                        const cells = parentRow.querySelectorAll('td');
                        if (cells.length >= 3) {
                            copyText = `${cells[1].textContent}\t${cells[2].textContent}`;
                        }
                    }
                }
            
                if (copyText) {
                    copyToClipboard(copyText.trim());
                    showNotification('‚úÖ ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶ì ‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');

                    const tableRows = resultsTableContainer.querySelectorAll('.result-table tbody tr');
                    tableRows.forEach(row => {
                        if (selection.containsNode(row, true)) {
                            row.classList.add('copied');
                        }
                    });
                } else {
                     showNotification('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§', 'error');
                }
            };

            const copyAllHoldingKhatian = () => {
                const table = resultsTableContainer.querySelector('.result-table');
                if (!table) {
                    showNotification('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶®‡ßá‡¶á!', 'error');
                    return;
                }

                const rows = table.querySelectorAll('tbody tr');
                if (rows.length === 0) {
                    showNotification('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á!', 'error');
                    return;
                }

                let allCopyText = [];
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length >= 3) {
                        allCopyText.push(`${cells[1].textContent}\t${cells[2].textContent}`);
                    }
                });

                if (allCopyText.length > 0) {
                    copyToClipboard(allCopyText.join('\n'));
                    showNotification('‚úÖ ‡¶∏‡¶¨ ‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶ø‡¶Ç ‡¶ì ‡¶ñ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');

                    rows.forEach(row => {
                        row.classList.add('copied');
                    });
                } else {
                    showNotification('‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§', 'error');
                }
            };

            const clearAll = () => {
                inputText.value = '';
                sessionStorage.removeItem('inputTextContent');
                resultsTableContainer.innerHTML = '<div class="empty-state">‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá‡•§</div>';
                showNotification('‡¶∏‡¶¨‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§', 'success');
            };

            rearrangeBtn.addEventListener('click', rearrangeText);
            copyAllBtn.addEventListener('click', copyAllHoldingKhatian);
            clearBtn.addEventListener('click', clearAll);

            if (savedText && savedText.trim()) {
                rearrangeText();
            }
        });
    </script>

</body>
</html>